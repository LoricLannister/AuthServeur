<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: SessionValidator</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: SessionValidator</h1>

    




<section>

<header>
    
        <h2>SessionValidator</h2>
        
            <div class="class-description">This class defines and implements an HTTP session validator.  It requires a
web service which returns a valid JSON session object in the form indicated
below  The given service should not manipulate the session in any way, it
should simply return information about the session in the specified format.
<p/>
This class also requires jQuery to be present.
<p/>
Once a result from the server is obtained, the callback will be called.
The jQuery document ready has already been fired at this point, and there
is no need to wrap your code in a jQuery(function(){}) block</div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    <h4 class="name" id="SessionValidator"><span class="type-signature"></span>new SessionValidator<span class="signature">(options)</span><span class="type-signature"></span></h4>

    



<div class="description">
    Setup the SessionValidator.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">
                <h6>Properties</h6>
                

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>validate_url</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last">The GET url which returns a proper
JSON session object instance</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>refresh_url</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last">The url you'd like to support
refreshing the session. null if you do not need this functionality.  See
the refresh() method for more information.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>timeout_url</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last">The url you'd like to redirect to when
the session times
out. nul if you do not need this functionality.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>callback</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last">The callback in the form
"function(result){}", where
result is in the form { sessionValid: true, sessionTime: 600}</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>check_frequency</code></td>
            

            <td class="type">
            
                
<span class="param-type">String</span>


            
            </td>

            

            

            <td class="description last">How often should the session
check web service be called, in seconds.</td>
        </tr>

    
    </tbody>
</table>

            </td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="public_js_session-validator.js.html">public/js/session-validator.js</a>, <a href="public_js_session-validator.js.html#line81">line 81</a>
    </li></ul></dd>
    

    

    

    
</dl>















    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// The web service should simply return a json object like this...
curl -H 'Accept: application/json' http://localhost:3000/check-session
{ sessionValid: true, sessionTime: 600 }

// The following code will work with the example html snippet at the bottom.
  function displayTime(result) {
    jQuery('#session-time').text(Math.ceil(result.sessionTime / 60) + 'm or ' +
          result.sessionTime + 's');
  };
  let sessionValidator = new SessionValidator({validate_url:
    'http://localhost:3000/check-session', refresh_url:
    'http://localhost:3000/refresh-session', check_frequency: 1,
    timeout_url: 'http://localhost:3000/timeout', callback:
    function (result)
    {
      displayTime(result);
      if (result.sessionTime &lt; 60)
      {
        jQuery('#more-time').show();
      }
    }});
  sessionValidator.monitor();

  jQuery(function ()
  {
    jQuery('#refresh').unbind('click').bind('click', function(event)
    {
      sessionValidator.refresh();
      jQuery('#more-time').hide();
      displayTime({sessionValid: true, sessionTime: 600});
    });
  });

// With the above code, the following will occur...
// The "more-time" div will be displayed when less than 1 minute is left in
// the session

// The "refresh" button can be clicked to refresh the time

// The "session-time" will have it's contents replaced with the time left.
&lt;div>
  &lt;span id="session-message">Your session will expire in:&lt;/span>
  &lt;span id="session-time">&lt;/span>
&lt;/div>
&lt;div id="more-time" style="display:none;">
  &lt;button id="refresh" name="I need more time">I need more time&lt;/button>
&lt;/div></code></pre>



    
    </div>

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="monitor"><span class="type-signature"></span>monitor<span class="signature">()</span><span class="type-signature"></span></h4>

    



<div class="description">
    Starts the session monitoring process by using setTimeout().  We get
the session time left every 10 seconds, subsequently calling the callback.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="public_js_session-validator.js.html">public/js/session-validator.js</a>, <a href="public_js_session-validator.js.html#line118">line 118</a>
    </li></ul></dd>
    

    

    

    
</dl>
















        
            

    

    <h4 class="name" id="refresh"><span class="type-signature"></span>refresh<span class="signature">()</span><span class="type-signature"></span></h4>

    



<div class="description">
    The refresh url should accept a simple empty post, with no parameters.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="public_js_session-validator.js.html">public/js/session-validator.js</a>, <a href="public_js_session-validator.js.html#line168">line 168</a>
    </li></ul></dd>
    

    

    

    
</dl>
















        
            

    

    <h4 class="name" id="stop"><span class="type-signature"></span>stop<span class="signature">()</span><span class="type-signature"></span></h4>

    



<div class="description">
    Stops the session monitoring by using clearInterval().
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="public_js_session-validator.js.html">public/js/session-validator.js</a>, <a href="public_js_session-validator.js.html#line183">line 183</a>
    </li></ul></dd>
    

    

    

    
</dl>
















        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="SessionManager.html">SessionManager</a></li><li><a href="SessionValidator.html">SessionValidator</a></li></ul><h3>Global</h3><ul><li><a href="global.html#express">express</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Sat May 20 2017 13:41:42 GMT-0600 (MDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>