{"version":3,"sources":["../../../app/controllers/session.js"],"names":["express","require","router","Router","sessionManager","SessionManager","module","exports","app","use","get","req","res","next","expire","query","expireSession","send","session","post","time","body","console","log","sessionValid","sessionTime"],"mappings":";;AAAA;;;;;AAKA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AAAA,IACEC,SAASF,QAAQG,MAAR,EADX;AAAA,IAEEC,iBAAiBH,QAAQ,oBAAR,EAA8BI,cAFjD;;AAIAC,OAAOC,OAAP,GAAiB,UAAUC,GAAV,EACjB;AACEA,MAAIC,GAAJ,CAAQ,GAAR,EAAaP,MAAb;AACD,CAHD;;AAKAA,OAAOQ,GAAP,CAAW,gBAAX,EAA6B,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAC7B;AACE,MAAIC,SAASH,IAAII,KAAJ,CAAUD,MAAvB;;AAEA;AACA,MAAIA,WAAW,MAAf,EACA;AACEV,mBAAeY,aAAf;AACD;;AAEDJ,MAAIK,IAAJ,CAASb,eAAec,OAAxB;AACD,CAXD;;AAaAhB,OAAOiB,IAAP,CAAY,kBAAZ,EAAgC,UAAUR,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAChC;AACE,MAAIO,OAAOT,IAAIU,IAAJ,CAASD,IAApB;AACAE,UAAQC,GAAR,CAAYH,IAAZ;AACA,MAAIhB,eAAec,OAAf,CAAuBM,YAA3B,EACA;AAAE;AACA;AACApB,mBAAec,OAAf,CAAuBO,WAAvB,GAAqCL,OAAKA,IAAL,GAAU,GAA/C;AACD;AACDR,MAAIK,IAAJ,CAASb,eAAec,OAAxB;AACD,CAVD","file":"session.js","sourcesContent":["/**\n * We're only simulating sessions here, so this is just a hack to get the job\n * done.  We're sharing the session among all clients.\n */\n\nvar express = require('express'),\n  router = express.Router(),\n  sessionManager = require('../session_manager').SessionManager;\n\nmodule.exports = function (app)\n{\n  app.use('/', router);\n};\n\nrouter.get('/check-session', function (req, res, next)\n{\n  let expire = req.query.expire;\n\n  // bad practise changing state with a GET request, this is only a test.\n  if (expire === 'true')\n  {\n    sessionManager.expireSession();\n  }\n\n  res.send(sessionManager.session);\n});\n\nrouter.post('/refresh-session', function (req, res, next)\n{\n  let time = req.body.time;\n  console.log(time);\n  if (sessionManager.session.sessionValid)\n  { // Only manipulate if the current session is valid.\n    // if no \"time\" parameter submitted, set to 600 seconds.\n    sessionManager.session.sessionTime = time?time:600;\n  }\n  res.send(sessionManager.session);\n});\n\n"]}